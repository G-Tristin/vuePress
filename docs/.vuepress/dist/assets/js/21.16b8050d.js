(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{195:function(s,t,a){"use strict";a.r(t);var e=a(0),r=Object(e.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("div",{staticClass:"content"},[a("h1",{attrs:{id:"express静态资源处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#express静态资源处理","aria-hidden":"true"}},[s._v("#")]),s._v(" express静态资源处理")]),s._v(" "),a("h2",{attrs:{id:"静态文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#静态文件","aria-hidden":"true"}},[s._v("#")]),s._v(" 静态文件")]),s._v(" "),a("p",[s._v("除非应用是纯 API 服务，否则总可能需要发送静态文件。这些文件可能是静态图片 CSS 样式文件或者是静态 HTML 文件")]),s._v(" "),a("h3",{attrs:{id:"静态文件中间件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#静态文件中间件","aria-hidden":"true"}},[s._v("#")]),s._v(" 静态文件中间件")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("app.use(express.static('静态资源路径'))\napp.use('/static',express.static('静态资源路径')) //这种方式给访问静态资源的路径进行设置\n")])])]),a("p",[s._v("eg:\n假设我们的静态资源被放在了public文件夹当中")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("const express = require('express')\nconst app = express()\napp.use(express.static('public'))\napp.listen(3000)\n")])])]),a("p",[s._v("我们可以直接访问public目录中的所有文件")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("http://localhost:3000/images/kitten.jpg\nhttp://localhost:3000/css/style.css\nhttp://localhost:3000/js/app.js\nhttp://localhost:3000/images/bg.png\nhttp://localhost:3000/hello.html\n")])])]),a("p",[s._v("如果我们使用以下方式")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("app.use('/static',express.static('public'))\n")])])]),a("p",[s._v("那么我们可以使用加了url前缀的方式访问")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("http://localhost:3000/static/images/kitten.jpg\nhttp://localhost:3000/static/css/style.css\nhttp://localhost:3000/static/js/app.js\nhttp://localhost:3000/static/images/bg.png\nhttp://localhost:3000/static/hello.html\n")])])]),a("p",[s._v("为什么要使用添加url前缀的方式来访问静态资源?")]),s._v(" "),a("ul",[a("li",[s._v("静态资源如果被分开存放在不同的目录当中我们可以使用app.use()多次引入")]),s._v(" "),a("li",[s._v("如果不同目录中存在同名的静态资源如果不设置url前缀那么会默认使用第一个目录下的资源")])]),s._v(" "),a("h3",{attrs:{id:"动态路由响应静态文件的情形"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#动态路由响应静态文件的情形","aria-hidden":"true"}},[s._v("#")]),s._v(" 动态路由响应静态文件的情形")]),s._v(" "),a("p",[s._v("当有人发起 /users/:userid/profile_photo 请求时，我们都需要响应对应 userid 用户的图片.静态中间件本身时无法处理该需求，不过好在 Express 可以使用与静态中间件类似的机制来处理这种情况.")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("app.use('/users/:userid/profile_photo',function(req,res){\n  res.sendFile(getProfilePhotoPath(req.params.userid))\n  //假设程序中存在一个名为 getProfilePhotoPath 的函数，该函数可以根据 userid 获取图片的存储路径\n})\n")])])])])}],!1,null,null,null);r.options.__file="express静态资源处理.md";t.default=r.exports}}]);